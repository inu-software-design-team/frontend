server {
    listen 80;
    server_name _;  # 모든 도메인을 처리하려면 '_'를 사용
    root /usr/share/nginx/html;  # 정적 파일이 위치할 경로
    index index.html;

    # React/Vite/Next.js 등의 빌드 파일 제공
    location / {
        try_files $uri /index.html;  # SPA 앱에 필요한 설정
    }

    # 정적 파일에 대한 캐시 설정 (ico, css, js, 이미지 등)
    location ~* \.(?:ico|css|js|gif|jpe?g|png|woff2?|eot|ttf|svg|mp4|webm)$ {
        expires 6M;  # 6개월 동안 캐시
        access_log off;  # 접근 로그 비활성화
        add_header Cache-Control "public";  # 캐시가 공용으로 설정
    }

    # 모든 /students 요청을 backend 컨테이너로 전달
    location /api {
        proxy_pass http://backend:4000;  # Docker Compose에서 정의된 backend 서비스
        proxy_set_header Host $host;  # 요청한 호스트 이름을 전달
        proxy_set_header X-Real-IP $remote_addr;  # 실제 클라이언트의 IP 주소
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # 프록시 체인 추가
        proxy_set_header X-Forwarded-Proto $scheme;  # HTTP/HTTPS 프로토콜
    }

}
